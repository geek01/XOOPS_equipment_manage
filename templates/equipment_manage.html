<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <script
            src="https://code.jquery.com/jquery-3.1.1.min.js"
            integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
            crossorigin="anonymous"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.0/knockout-min.js"></script>
    <script>
        ko.applyBindings({

          data:{
              name: ko.observable(""),
              amount: ko.observable(0),
              id: ko.observable(0)
          },
          update_data:function (value) {
              this.data.name(value.name);
              this.data.amount(value.amount);
              this.data.id(value.id);
              $('#update_form').show();
              $('#add_form').hide();
          }

        });
    </script>

</head>
<body>
    <form action="crud/delete.php" method="post" enctype="multipart/form-data">
        <table class="table">
            <thead>
                <tr>
                    <td>名稱</td>
                    <td>持有者</td>
                    <td>數量</td>
                    <td>操作</td>
                </tr>
            </thead>
            <tbody>
                <{foreach from=$query_rows item=row}>
                    <tr>
                        <{foreach from=$row item=elem name=it}>
                            <td>
                                <{if $smarty.foreach.it.index != 3}>
                                    <{$elem}>
                                <{else}>
                                    <input type="submit" value="刪除"
                                           onclick="$('#delete_id').val(<{$elem}>);" />
                                    <button>
                                        修改
                                    </button>
                                <{/if}>
                            </td>
                        <{/foreach}>
                    </tr>
                <{/foreach}>
            </tbody>
        </table>
        <input type="hidden" id="delete_id" name="delete_id"/>
    </form>

    <button onclick="$('#add_form').toggle(); $('#update_form').hide();">新增資料</button>
    <form action="crud/append.php" METHOD="post" enctype="multipart/form-data">
        <table id="add_form" style="display: none;">
            <tbody>
                <tr>
                    <td>
                        名稱
                        <input type="text" name="name" pattern="[^-*.,!;'><\[\]=\+?/\\]+">
                    </td>
                    <td>
                        數量
                        <input type="text" name="amount" pattern="[1-9]\d*">
                    </td>
                    <td>
                        <input type="submit" value="確認新增">
                    </td>
                </tr>
            </tbody>
        </table>
    </form>

    <form action="crud/update.php" METHOD="post" enctype="multipart/form-data">
        <table id="update_form" style="display: none;">
            <tbody>
                <tr>
                    <td>
                        名稱
                        <input data-bind="textInput:data.name" name="name" pattern="[^-*.,!;'><\[\]=\+?/\\]+">
                    </td>
                    <td>
                        數量
                        <input data-bind="textInput:data.amount" name="amount" pattern="[1-9]\d*">
                    </td>
                    <td>
                        <input type="submit" value="確認修改">
                    </td>
                </tr>
            </tbody>
        </table>
    </form>

</body>
</html>